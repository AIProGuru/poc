steps:
- name: 'gcr.io/cloud-builders/docker'
  args: [ 'build', '-t', 'us-central1-docker.pkg.dev/$PROJECT_ID/gabeo-website-frontend/gabeo-website-frontend:${BRANCH_NAME}-$COMMIT_SHA', '--build-arg', 'REACT_APP_SERVER_URL=${_REACT_APP_SERVER_URL}', 
    '--build-arg', 'REACT_APP_USER_POOL_ID=${_REACT_APP_USER_POOL_ID}', '--build-arg', 'REACT_APP_CLIENT_ID=${_REACT_APP_CLIENT_ID}', '--build-arg', 'REACT_APP_AWS_ACCESS_KEY_ID=${_REACT_APP_AWS_ACCESS_KEY_ID}', '--build-arg', 'REACT_APP_AWS_SECRET_ACCESS_KEY=${_REACT_APP_AWS_SECRET_ACCESS_KEY}', '--build-arg', 'REACT_APP_AWS_REGION=${_REACT_APP_AWS_REGION}','--build-arg', 'REACT_APP_MAINTAINING=${_REACT_APP_MAINTAINING}','./']
- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'us-central1-docker.pkg.dev/$PROJECT_ID/gabeo-website-frontend/gabeo-website-frontend:${BRANCH_NAME}-$COMMIT_SHA']
- name: 'gcr.io/cloud-builders/gcloud'
  args: ['run', 'deploy', '${_CLOUD_RUN_SERVICE}', '--image', 'us-central1-docker.pkg.dev/$PROJECT_ID/gabeo-website-frontend/gabeo-website-frontend:${BRANCH_NAME}-$COMMIT_SHA', '--region', 'us-central1', '--platform', 'managed', '--allow-unauthenticated']
