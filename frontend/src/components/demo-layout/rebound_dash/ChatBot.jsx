import React, { useState, useEffect, useRef } from "react";
import { useDispatch, useSelector } from "react-redux";
import axios from "axios";
import { toast } from "react-toastify";

import {
  setShowSampleQuestion,
  setMessages,
  setGenerating,
  setShowGPT,
} from "../../../redux/reducers/gpt.reducer";
import { SERVER_URL, rcmGPTDateFormat } from "../../../utils/config";
import { useOnClickOutside } from "usehooks-ts";
import { Dialog } from "@mui/material";
import ChatHistoryButton from "./ChatHistoryButton";

const ChatBot = () => {
  const [activeChat, setActiveChat] = useState(null);

  const [chats, setChats] = useState({
    today: [],
    yesterday: [],
    lastWeek: [],
    older: [],
  });

  const dispatch = useDispatch();

  const email = useSelector((state) => state.auth.email);
  const showSampleQuestion = useSelector(
    (state) => state.gpt.showSampleQuestion
  );
  const messages = useSelector((state) => state.gpt.messages);
  const generating = useSelector((state) => state.gpt.generating);
  const showChatBot = useSelector((state) => state.gpt.showGPT);

  const [prompt, setPrompt] = useState("");

  const [showHistory, setShowHistory] = useState(false);

  const [showModal, setShowModal] = useState(false);

  const messageContainer = useRef(null);

  const modalMessageContainer = useRef(null);

  const history = useRef(null);

  const onClosehistory = () => {
    setShowHistory(false);
  };

  useOnClickOutside(history, onClosehistory);

  const formatText = (text) => {
    const parts = text.split(/(\*\*.*?\*\*|\*.*?\*|`.*?`)/g);
    return parts.map((part, index) => {
      if (part.startsWith("**") && part.endsWith("**")) {
        return <strong key={index}>{part.slice(2, -2)}</strong>;
      } else if (part.startsWith("*") && part.endsWith("*")) {
        return <em key={index}>{part.slice(1, -1)}</em>;
      } else if (part.startsWith("`") && part.endsWith("`")) {
        return <code key={index}>{part.slice(1, -1)}</code>;
      }
      return part;
    });
  };

  useEffect(() => {
    if (messages.length > 0) {
      messageContainer.current.scrollBy(0, 9999);
      if (modalMessageContainer.current)
        modalMessageContainer.current.scrollBy(0, 9999);
    }
  }, [messages]);

  useEffect(() => {
    if (email) {
      // Fetch chats from the backend
      axios
        .get(`${SERVER_URL}/v2/medevolve/chats`, {
          params: { user_email: email },
        })
        .then((response) => {
          console.log(response.data.chats);
          setChats(response.data.chats);

          setChats({
            today: [...response.data.chats.today],
            yesterday: [...response.data.chats.yesterday],
            lastWeek: [...response.data.chats.lastWeek],
            older: [...response.data.chats.older],
          });
        })
        .catch((error) => console.error("Error fetching chats:", error));
    }
  }, [email]);

  useEffect(() => {
    if(messages.length > 0)
      dispatch(setShowSampleQuestion(false))
  }, [messages])

  const generateResult = (msg, value) => {
    dispatch(setGenerating(true));
    axios
      .post(`${SERVER_URL}/v2/normalchat_query`, {
        query: value,
        chat: "Medicare",
        first: messages.length === 0,
      })
      .then((res) => {
        console.log(res);
        dispatch(
          setMessages([
            ...msg,
            {
              type: 1,
              content: res.data.answer,
              time: new Date().getTime(),
            },
          ])
        );
        dispatch(setGenerating(false));
      })
      .catch((res) => {
        dispatch(setGenerating(false));
      });
  };

  const sendPrompt = (value) => {
    if (value === "") return;
    var msg = [
      ...messages,
      {
        type: 0,
        content: value,
        time: new Date().getTime(),
      },
    ];
    dispatch(setMessages(msg));
    dispatch(setGenerating(true));
    setPrompt("");
    axios
      .post(`${SERVER_URL}/v2/medevolve/chat`, {
        email: email,
        query: value,
        isFirst: messages.length === 0,
        chatID: activeChat,
      })
      .then((res) => {
        console.log("asdfasdfasdf", res);
        dispatch(
          setMessages([
            ...msg,
            {
              type: 1,
              content: res.data.answer,
              time: new Date().getTime(),
            },
          ])
        );
        dispatch(setGenerating(false));
      })
      .catch((res) => {
        dispatch(setGenerating(false));
      });
  };

  const process = () => {
    if (showChatBot) {
      dispatch(setShowGPT(false));
    }
  };

  const handleModalClose = () => {
    dispatch(setShowGPT(false));
  };

  const onNewChat = async () => {
    dispatch(setShowSampleQuestion(true));
    dispatch(setMessages([]));
  };

  const loadChats = (chatUuid) => {
    setActiveChat(chatUuid);
    axios
      .get(`${SERVER_URL}/v2/medevolve/chat`, {
        params: { chatUuid: chatUuid },
      })
      .then((response) => {
        console.log("Chat data:", response.data);

        const { chats } = response.data;
        const payload = [];
        chats.reverse().map((chat) => {
          payload.push({
            type: 0,
            content: chat.query,
            time: new Date(chat.updated_at)
          });

          payload.push({
            type: 1,
            content: chat.response,
            time: new Date(chat.updated_at)
          });
        });

        dispatch(setMessages(payload));
        dispatch(setShowSampleQuestion(false));
      })
      .catch((error) => {
        console.error("Error loading chat:", error);
      });
  };

  return (
    <div className="grow flex flex-col w-full p-1 h-full">
      <div className="flex justify-between p-4 border-b md:border-b-0">
        <div className="flex gap-4 items-center">
          <div
            className="block md:hidden cursor-pointer"
            onClick={() => setShowHistory(true)}
          >
            <svg width="1.5em" height="1.5em" viewBox="0 0 24 24">
              <g
                fill="none"
                stroke="#1C274C"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
              >
                <path d="M21.25 7.506v6.607a3.963 3.963 0 0 1-3.964 3.965h-2.643l-2.18 2.18a.636.636 0 0 1-.925 0l-2.18-2.18H6.713a3.964 3.964 0 0 1-3.964-3.965V7.506a3.964 3.964 0 0 1 3.964-3.964h10.572a3.964 3.964 0 0 1 3.964 3.964" />
                <path d="M12 11.338a.66.66 0 1 0 0-1.321a.66.66 0 0 0 0 1.321m4.625 0a.66.66 0 1 0 0-1.321a.66.66 0 0 0 0 1.321m-9.25 0a.66.66 0 1 0 0-1.321a.66.66 0 0 0 0 1.321" />
              </g>
            </svg>
          </div>
          <div>
            <svg width="1.5em" height="1.5em" viewBox="0 0 24 24">
              <path
                fill="currentColor"
                d="M18.22 20.75H5.78A2.64 2.64 0 0 1 3.25 18v-3a.75.75 0 0 1 1.5 0v3a1.16 1.16 0 0 0 1 1.25h12.47a1.16 1.16 0 0 0 1-1.25v-3a.75.75 0 0 1 1.5 0v3a2.64 2.64 0 0 1-2.5 2.75"
              />
              <path
                fill="currentColor"
                d="M12 15.75a.74.74 0 0 1-.53-.22l-4-4a.75.75 0 0 1 1.06-1.06L12 13.94l3.47-3.47a.75.75 0 0 1 1.06 1.06l-4 4a.74.74 0 0 1-.53.22"
              />
              <path
                fill="#1C274C"
                d="M12 15.75a.76.76 0 0 1-.75-.75V4a.75.75 0 0 1 1.5 0v11a.76.76 0 0 1-.75.75"
              />
            </svg>
          </div>
          <div
            className="hidden md:block cursor-pointer"
            onClick={() => setShowModal(true)}
          >
            <svg width="1.5em" height="1.5em" viewBox="0 0 24 24">
              <path
                fill="none"
                stroke="#1C274C"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M10 19H5v-5m9-9h5v5"
              />
            </svg>
          </div>
        </div>
        <div className="flex gap-4 items-center md:hidden">
          <svg
            width="126"
            height="32"
            viewBox="0 0 126 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <circle cx="16.1409" cy="16" r="15.5" stroke="#D2DDF3" />
            <path
              d="M8.00024 9.45909C8.00024 8.65326 8.64944 8 9.45026 8H10.5502C11.351 8 12.0002 8.65326 12.0002 9.45909V10.5409C12.0002 11.3467 11.351 12 10.5502 12H9.45026C8.64944 12 8.00024 11.3467 8.00024 10.5409V9.45909Z"
              fill="#1E47D1"
            />
            <path
              d="M14.0002 9.45909C14.0002 8.65326 14.6494 8 15.4503 8H16.5502C17.351 8 18.0002 8.65326 18.0002 9.45909V10.5409C18.0002 11.3467 17.351 12 16.5502 12H15.4503C14.6494 12 14.0002 11.3467 14.0002 10.5409V9.45909Z"
              fill="#4DA7ED"
            />
            <path
              d="M20.0002 9.45909C20.0002 8.65326 20.6494 8 21.4503 8H22.5502C23.351 8 24.0002 8.65326 24.0002 9.45909V10.5409C24.0002 11.3467 23.351 12 22.5502 12H21.4503C20.6494 12 20.0002 11.3467 20.0002 10.5409V9.45909Z"
              fill="#3172DC"
            />
            <path
              d="M8.00024 15.4591C8.00024 14.6533 8.64944 14 9.45026 14H10.5502C11.351 14 12.0002 14.6533 12.0002 15.4591V16.5409C12.0002 17.3467 11.351 18 10.5502 18H9.45026C8.64944 18 8.00024 17.3467 8.00024 16.5409V15.4591Z"
              fill="#4DA7ED"
            />
            <path
              d="M14.0002 15.4591C14.0002 14.6533 14.6494 14 15.4503 14H16.5502C17.351 14 18.0002 14.6533 18.0002 15.4591V16.5409C18.0002 17.3467 17.351 18 16.5502 18H15.4503C14.6494 18 14.0002 17.3467 14.0002 16.5409V15.4591Z"
              fill="#3172DC"
            />
            <path
              d="M20.0002 15.4591C20.0002 14.6533 20.6494 14 21.4503 14H22.5502C23.351 14 24.0002 14.6533 24.0002 15.4591V16.5409C24.0002 17.3467 23.351 18 22.5502 18H21.4503C20.6494 18 20.0002 17.3467 20.0002 16.5409V15.4591Z"
              fill="#73F7FA"
            />
            <path
              d="M8.00024 21.4591C8.00024 20.6533 8.64944 20 9.45026 20H10.5502C11.351 20 12.0002 20.6533 12.0002 21.4591V22.5409C12.0002 23.3467 11.351 24 10.5502 24H9.45026C8.64944 24 8.00024 23.3467 8.00024 22.5409V21.4591Z"
              fill="#3B83E3"
            />
            <path
              d="M14.0002 21.4591C14.0002 20.6533 14.6494 20 15.4503 20H16.5502C17.351 20 18.0002 20.6533 18.0002 21.4591V22.5409C18.0002 23.3467 17.351 24 16.5502 24H15.4503C14.6494 24 14.0002 23.3467 14.0002 22.5409V21.4591Z"
              fill="#73F7FA"
            />
            <path
              d="M20.0002 21.4591C20.0002 20.6533 20.6494 20 21.4503 20H22.5502C23.351 20 24.0002 20.6533 24.0002 21.4591V22.5409C24.0002 23.3467 23.351 24 22.5502 24H21.4503C20.6494 24 20.0002 23.3467 20.0002 22.5409V21.4591Z"
              fill="#3B83E3"
            />
            <path
              d="M111.433 23.0683V12.8094H107.387V10.4253H118.404V12.8094H114.359V23.0683H111.433Z"
              fill="#1E47D1"
            />
            <path
              d="M95.0118 23.0683V10.4253H100.484C101.616 10.4253 102.592 10.6119 103.41 10.9852C104.229 11.3464 104.861 11.8702 105.307 12.5565C105.752 13.2429 105.975 14.0617 105.975 15.0129C105.975 15.9521 105.752 16.7648 105.307 17.4512C104.861 18.1375 104.229 18.6673 103.41 19.0406C102.592 19.4018 101.616 19.5824 100.484 19.5824H96.6374L97.9378 18.2639V23.0683H95.0118ZM97.9378 18.589L96.6374 17.1983H100.322C101.225 17.1983 101.899 17.0057 102.345 16.6204C102.79 16.235 103.013 15.6992 103.013 15.0129C103.013 14.3145 102.79 13.7727 102.345 13.3874C101.899 13.0021 101.225 12.8094 100.322 12.8094H96.6374L97.9378 11.4187V18.589Z"
              fill="#1E47D1"
            />
            <path
              d="M86.0999 23.285C85.1005 23.285 84.1794 23.1284 83.3365 22.8154C82.5057 22.4902 81.7772 22.0327 81.1511 21.4427C80.537 20.8527 80.0553 20.1603 79.7062 19.3656C79.369 18.5709 79.2004 17.698 79.2004 16.7467C79.2004 15.7955 79.369 14.9225 79.7062 14.1278C80.0553 13.3331 80.543 12.6408 81.1691 12.0508C81.7953 11.4608 82.5298 11.0092 83.3726 10.6962C84.2155 10.371 85.1426 10.2085 86.1541 10.2085C87.2739 10.2085 88.2793 10.3951 89.1703 10.7684C90.0734 11.1417 90.832 11.6835 91.4461 12.3939L89.5677 14.1278C89.1101 13.6462 88.6104 13.291 88.0686 13.0622C87.5267 12.8214 86.9367 12.701 86.2986 12.701C85.6845 12.701 85.1246 12.7973 84.6189 12.99C84.1131 13.1826 83.6736 13.4595 83.3004 13.8208C82.9392 14.182 82.6562 14.6095 82.4515 15.1031C82.2588 15.5968 82.1625 16.1447 82.1625 16.7467C82.1625 17.3367 82.2588 17.8786 82.4515 18.3722C82.6562 18.8659 82.9392 19.2994 83.3004 19.6727C83.6736 20.0339 84.1071 20.3108 84.6008 20.5035C85.1065 20.6962 85.6604 20.7925 86.2624 20.7925C86.8404 20.7925 87.4003 20.7022 87.9422 20.5216C88.496 20.3289 89.0319 20.0098 89.5496 19.5643L91.2113 21.6775C90.5249 22.1952 89.7242 22.5926 88.8091 22.8695C87.906 23.1465 87.003 23.285 86.0999 23.285ZM88.5382 21.2982V16.548H91.2113V21.6775L88.5382 21.2982Z"
              fill="#1E47D1"
            />
            <path
              d="M72.2142 13.2065C72.9848 13.2065 73.6651 13.3631 74.2551 13.6761C74.8572 13.9772 75.3268 14.4468 75.6639 15.0849C76.0131 15.7111 76.1877 16.5178 76.1877 17.5052V23.0681H73.3701V17.9386C73.3701 17.156 73.2076 16.578 72.8825 16.2047C72.5574 15.8315 72.0998 15.6448 71.5098 15.6448C71.1004 15.6448 70.7332 15.7412 70.4081 15.9338C70.083 16.1144 69.8301 16.3914 69.6495 16.7646C69.4689 17.1379 69.3786 17.6135 69.3786 18.1915V23.0681H66.561V17.9386C66.561 17.156 66.3984 16.578 66.0733 16.2047C65.7603 15.8315 65.3087 15.6448 64.7187 15.6448C64.3093 15.6448 63.9421 15.7412 63.617 15.9338C63.2919 16.1144 63.039 16.3914 62.8584 16.7646C62.6778 17.1379 62.5875 17.6135 62.5875 18.1915V23.0681H59.7699V13.351H62.461V16.0061L61.9553 15.2294C62.2925 14.5672 62.7681 14.0675 63.3822 13.7303C64.0083 13.3811 64.7187 13.2065 65.5134 13.2065C66.4045 13.2065 67.1811 13.4353 67.8433 13.8929C68.5176 14.3384 68.9632 15.0247 69.1799 15.9519L68.1865 15.681C68.5116 14.9224 69.0294 14.3203 69.7398 13.8748C70.4622 13.4293 71.2871 13.2065 72.2142 13.2065Z"
              fill="#1E47D1"
            />
            <path
              d="M52.7118 23.2126C51.6642 23.2126 50.731 23.0018 49.9122 22.5804C49.0935 22.1469 48.4493 21.5509 47.9797 20.7923C47.5221 20.0338 47.2933 19.1728 47.2933 18.2096C47.2933 17.2342 47.5221 16.3733 47.9797 15.6268C48.4493 14.8682 49.0935 14.2782 49.9122 13.8568C50.731 13.4233 51.6642 13.2065 52.7118 13.2065C53.7352 13.2065 54.6263 13.4233 55.3848 13.8568C56.1434 14.2782 56.7033 14.8863 57.0646 15.681L54.8791 16.8549C54.6263 16.3974 54.3072 16.0602 53.9219 15.8435C53.5486 15.6268 53.1392 15.5184 52.6937 15.5184C52.2121 15.5184 51.7786 15.6268 51.3933 15.8435C51.008 16.0602 50.7009 16.3673 50.4721 16.7646C50.2554 17.162 50.147 17.6436 50.147 18.2096C50.147 18.7755 50.2554 19.2571 50.4721 19.6545C50.7009 20.0518 51.008 20.3589 51.3933 20.5756C51.7786 20.7923 52.2121 20.9007 52.6937 20.9007C53.1392 20.9007 53.5486 20.7984 53.9219 20.5937C54.3072 20.3769 54.6263 20.0338 54.8791 19.5642L57.0646 20.7562C56.7033 21.5389 56.1434 22.1469 55.3848 22.5804C54.6263 23.0018 53.7352 23.2126 52.7118 23.2126Z"
              fill="#1E47D1"
            />
            <path
              d="M39.2932 23.0681V13.351H41.9844V16.0964L41.6051 15.3017C41.8941 14.6153 42.3576 14.0976 42.9958 13.7484C43.634 13.3872 44.4106 13.2065 45.3257 13.2065V15.8074C45.2053 15.7953 45.0969 15.7893 45.0006 15.7893C44.9043 15.7773 44.8019 15.7713 44.6936 15.7713C43.923 15.7713 43.2968 15.994 42.8152 16.4395C42.3456 16.873 42.1108 17.5533 42.1108 18.4805V23.0681H39.2932Z"
              fill="#1E47D1"
            />
            <path
              d="M122.958 9.72588V7H123.277L124.5 9.05999H124.329L125.536 7H125.855L125.859 9.72588H125.485L125.482 7.58801H125.571L124.496 9.39488H124.317L123.235 7.58801H123.332V9.72588H122.958Z"
              fill="#1E47D1"
            />
            <path
              d="M121.058 9.72588V7.33879H120.124V7H122.379V7.33879H121.444V9.72588H121.058Z"
              fill="#1E47D1"
            />
          </svg>
        </div>
        <div
          className="flex text-center items-center justify-center cursor-pointer"
          onClick={process}
        >
          {!showChatBot && (
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19 13V14.2C19 15.8802 19 16.7202 18.673 17.362C18.3854 17.9265 17.9265 18.3854 17.362 18.673C16.7202 19 15.8802 19 14.2 19H5.8C4.11984 19 3.27976 19 2.63803 18.673C2.07354 18.3854 1.6146 17.9265 1.32698 17.362C1 16.7202 1 15.8802 1 14.2V13M15 8L10 13M10 13L5 8M10 13V1"
                stroke="#0D364D"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
              />
            </svg>
          )}
          {showChatBot && (
            <svg
              width="12"
              height="12"
              viewBox="0 0 12 12"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0.412046 0.41107C0.737483 0.0856329 1.26512 0.0856329 1.59056 0.41107L6.0013 4.82181L10.412 0.41107C10.7375 0.0856329 11.2651 0.0856329 11.5906 0.41107C11.916 0.736507 11.916 1.26414 11.5906 1.58958L7.17981 6.00033L11.5906 10.4111C11.916 10.7365 11.916 11.2641 11.5906 11.5896C11.2651 11.915 10.7375 11.915 10.412 11.5896L6.0013 7.17884L1.59056 11.5896C1.26512 11.915 0.737483 11.915 0.412046 11.5896C0.0866095 11.2641 0.0866095 10.7365 0.412046 10.4111L4.82279 6.00033L0.412046 1.58958C0.0866095 1.26414 0.0866095 0.736507 0.412046 0.41107Z"
                fill="#27222C"
              />
            </svg>
          )}
        </div>
      </div>
      <div className="md:h-[70vh] flex-1 md:flex-auto flex flex-col gap-2 bg-white rounded-2xl overflow-y-auto">
        <div
          className="flex-1 overflow-scroll flex flex-col gap-2 scroll-smooth px-4 py-2"
          ref={messageContainer}
        >
          {/* {messages.length == 0 && <div className='flex flex-col gap-4'>
          <div className='flex items-center gap-2'>
            <div className='flex-1'>
              <hr />
            </div>
            <div className='font-medium font-inter text-[24px] text-[#828385]'>What can we help you with today?</div>
            <div className='flex-1'>
              <hr />
            </div>
          </div>
          <div className='mx-auto w-max text-[#828385] font-medium font-inter text-[18px]'>
            <ul className='list-disc'>
              <li>Medicare Policies</li>
              <li>Timely Filing Guidelines</li>
              <li>CPT Descriptions</li>
              <li>Telehealth Services</li>
              <li>Claim Frequency Codes</li>
            </ul>
          </div>
        </div>} */}
          {messages.map((row, index) => {
            if (row.type === 0) {
              return (
                <div className="flex flex-col gap-3 w-1/2 self-end" key={index}>
                  <div className="flex justify-between items-center">
                    <div className="text-[#1A3F59] font-inter text-[14px] font-semibold">
                      You
                    </div>
                    <div className="text-[#45484C] text-[12px] font-normal font-inter">
                      {rcmGPTDateFormat(row.time)}
                    </div>
                  </div>
                  <div className="py-[14px] px-[10px] bg-[#3588FF] rounded-l-xl rounded-br-xl text-white text-[14px] font-normal font-inter">
                    {row.content}
                  </div>
                </div>
              );
            } else {
              return (
                <div className="flex gap-3 w-3/4" key={index}>
                  <div className="flex bg-white w-12 h-12 rounded-full justify-center items-center">
                    <svg
                      width="48"
                      height="48"
                      viewBox="0 0 835 462"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      \
                      <path
                        d="M417.431 245.818C484.709 245.818 539.249 191.278 539.249 124C539.249 56.7217 484.709 2.18182 417.431 2.18182C350.153 2.18182 295.613 56.7217 295.613 124C295.613 191.278 350.153 245.818 417.431 245.818Z"
                        stroke="#E1E1EA"
                        strokeWidth="3.63636"
                      />
                      \
                      <rect
                        x="341.067"
                        y="47.6365"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#1E47D1"
                      />
                      \
                      <rect
                        x="395.613"
                        y="47.6365"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#4DA7ED"
                      />
                      \
                      <rect
                        x="450.158"
                        y="47.6365"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#3172DC"
                      />
                      \
                      <rect
                        x="341.067"
                        y="102.182"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#4DA7ED"
                      />
                      \
                      <rect
                        x="395.613"
                        y="102.182"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#3172DC"
                      />
                      \
                      <rect
                        x="450.158"
                        y="102.182"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#73F7FA"
                      />
                      \
                      <rect
                        x="341.067"
                        y="156.727"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#3B83E3"
                      />
                      \
                      <rect
                        x="395.613"
                        y="156.727"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#73F7FA"
                      />
                      \
                      <rect
                        x="450.158"
                        y="156.727"
                        width="40"
                        height="40"
                        rx="14.5455"
                        fill="#3B83E3"
                      />
                      \
                      <path
                        d="M97.4191 422V342.15H119.534V364.71L116.417 358.179C118.792 352.539 122.601 348.285 127.845 345.415C133.089 342.447 139.471 340.963 146.991 340.963V362.335C146.002 362.236 145.111 362.187 144.32 362.187C143.528 362.088 142.687 362.038 141.797 362.038C135.464 362.038 130.319 363.869 126.361 367.53C122.502 371.092 120.573 376.682 120.573 384.301V422H97.4191ZM207.673 423.187C199.065 423.187 191.396 421.456 184.668 417.993C177.94 414.431 172.646 409.533 168.787 403.299C165.027 397.065 163.147 389.991 163.147 382.075C163.147 374.06 165.027 366.986 168.787 360.851C172.646 354.617 177.94 349.769 184.668 346.306C191.396 342.744 199.065 340.963 207.673 340.963C216.084 340.963 223.406 342.744 229.639 346.306C235.873 349.769 240.474 354.766 243.442 361.296L225.483 370.944C223.406 367.184 220.783 364.413 217.617 362.632C214.55 360.851 211.186 359.96 207.525 359.96C203.567 359.96 200.005 360.851 196.838 362.632C193.672 364.413 191.149 366.936 189.269 370.201C187.488 373.467 186.597 377.425 186.597 382.075C186.597 386.726 187.488 390.683 189.269 393.949C191.149 397.214 193.672 399.737 196.838 401.518C200.005 403.299 203.567 404.19 207.525 404.19C211.186 404.19 214.55 403.349 217.617 401.666C220.783 399.885 223.406 397.065 225.483 393.207L243.442 403.002C240.474 409.434 235.873 414.431 229.639 417.993C223.406 421.456 216.084 423.187 207.673 423.187ZM367.94 340.963C374.272 340.963 379.863 342.249 384.711 344.822C389.659 347.295 393.518 351.154 396.288 356.398C399.158 361.544 400.592 368.173 400.592 376.287V422H377.439V379.849C377.439 373.417 376.103 368.668 373.431 365.6C370.76 362.533 367 360.999 362.152 360.999C358.787 360.999 355.769 361.791 353.098 363.374C350.426 364.858 348.348 367.134 346.864 370.201C345.38 373.269 344.638 377.177 344.638 381.927V422H321.484V379.849C321.484 373.417 320.149 368.668 317.477 365.6C314.904 362.533 311.194 360.999 306.346 360.999C302.981 360.999 299.964 361.791 297.292 363.374C294.62 364.858 292.543 367.134 291.058 370.201C289.574 373.269 288.832 377.177 288.832 381.927V422H265.679V342.15H287.793V363.968L283.637 357.586C286.408 352.144 290.316 348.037 295.363 345.267C300.508 342.397 306.346 340.963 312.876 340.963C320.198 340.963 326.58 342.843 332.022 346.603C337.563 350.264 341.224 355.904 343.005 363.523L334.842 361.296C337.514 355.063 341.768 350.115 347.606 346.454C353.543 342.793 360.321 340.963 367.94 340.963ZM482.049 423.781C473.837 423.781 466.267 422.495 459.341 419.922C452.514 417.251 446.527 413.491 441.382 408.642C436.336 403.794 432.378 398.104 429.509 391.574C426.738 385.043 425.353 377.87 425.353 370.053C425.353 362.236 426.738 355.063 429.509 348.532C432.378 342.002 436.385 336.312 441.531 331.464C446.676 326.615 452.712 322.905 459.638 320.332C466.564 317.661 474.183 316.325 482.495 316.325C491.697 316.325 499.959 317.859 507.281 320.926C514.702 323.993 520.935 328.446 525.982 334.284L510.546 348.532C506.786 344.574 502.68 341.655 498.227 339.775C493.774 337.796 488.926 336.807 483.682 336.807C478.636 336.807 474.035 337.599 469.879 339.182C465.723 340.765 462.112 343.041 459.044 346.009C456.076 348.977 453.751 352.49 452.068 356.547C450.485 360.604 449.694 365.106 449.694 370.053C449.694 374.901 450.485 379.354 452.068 383.411C453.751 387.468 456.076 391.03 459.044 394.097C462.112 397.065 465.674 399.341 469.73 400.924C473.886 402.508 478.438 403.299 483.385 403.299C488.134 403.299 492.735 402.557 497.188 401.073C501.74 399.49 506.143 396.868 510.397 393.207L524.052 410.572C518.412 414.826 511.832 418.092 504.312 420.367C496.891 422.643 489.47 423.781 482.049 423.781ZM502.086 407.455V368.42H524.052V410.572L502.086 407.455ZM555.292 422V318.106H600.263C609.564 318.106 617.579 319.64 624.307 322.707C631.036 325.675 636.231 329.98 639.892 335.62C643.553 341.26 645.383 347.988 645.383 355.805C645.383 363.523 643.553 370.201 639.892 375.841C636.231 381.481 631.036 385.835 624.307 388.902C617.579 391.871 609.564 393.355 600.263 393.355H568.65L579.336 382.52V422H555.292ZM579.336 385.192L568.65 373.764H598.928C606.349 373.764 611.89 372.18 615.551 369.014C619.212 365.848 621.042 361.445 621.042 355.805C621.042 350.066 619.212 345.613 615.551 342.447C611.89 339.281 606.349 337.697 598.928 337.697H568.65L579.336 326.269V385.192ZM690.221 422V337.697H656.975V318.106H747.511V337.697H714.265V422H690.221Z"
                        fill="#1E47D1"
                      />
                      \
                      <path
                        d="M763.996 314V294.384H756.316V291.6H774.844V294.384H767.164V314H763.996ZM779.609 314V291.6H782.233L792.281 308.528H790.873L800.793 291.6H803.417L803.449 314H800.377L800.345 296.432H801.081L792.249 311.28H790.777L781.881 296.432H782.681V314H779.609Z"
                        fill="#1E47D1"
                      />
                      \
                    </svg>
                  </div>
                  <div className="flex flex-col w-full gap-2">
                    <div className="flex items-center justify-between">
                      <div className="font-semibold text-[14px] font-inter"></div>
                      <div className="text-[12px] font-normal font-inter text-[#45484C]">
                        {rcmGPTDateFormat(row.time)}
                      </div>
                    </div>
                    <div className="bg-[#E7EFFA66] text-[#151618] text-[14px] font-normal px-[10px] py-[14px] rounded-r-xl rounded-bl-xl select-text">
                      {row.content.split("\n").map((line, index) => (
                        <div key={index}>{formatText(line)}</div>
                      ))}
                    </div>
                    <div className="flex gap-2">
                      <div className="cursor-pointer">
                        <svg width="16" height="16" viewBox="0 0 24 24">
                          <path
                            fill="none"
                            stroke="#828385"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M15.5 8.43A5 5 0 0 1 17 12a4.98 4.98 0 0 1-1.43 3.5m2.794 2.864A8.97 8.97 0 0 0 21 12a8.97 8.97 0 0 0-2.636-6.364M12 6.135v11.73a1 1 0 0 1-1.64.768L6 15H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h2l4.36-3.633a1 1 0 0 1 1.64.768"
                          />
                        </svg>
                      </div>
                      <div
                        className="cursor-pointer"
                        onClick={() => {
                          navigator.clipboard.writeText(row.content);
                          toast.success("Text copied!", {
                            position: "bottom-center",
                          });
                        }}
                      >
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 22 22"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M4 14C3.06812 14 2.60218 14 2.23463 13.8478C1.74458 13.6448 1.35523 13.2554 1.15224 12.7654C1 12.3978 1 11.9319 1 11V4.2C1 3.0799 1 2.51984 1.21799 2.09202C1.40973 1.71569 1.71569 1.40973 2.09202 1.21799C2.51984 1 3.0799 1 4.2 1H11C11.9319 1 12.3978 1 12.7654 1.15224C13.2554 1.35523 13.6448 1.74458 13.8478 2.23463C14 2.60218 14 3.06812 14 4M11.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V11.2C21 10.0799 21 9.51984 20.782 9.09202C20.5903 8.71569 20.2843 8.40973 19.908 8.21799C19.4802 8 18.9201 8 17.8 8H11.2C10.0799 8 9.51984 8 9.09202 8.21799C8.71569 8.40973 8.40973 8.71569 8.21799 9.09202C8 9.51984 8 10.0799 8 11.2V17.8C8 18.9201 8 19.4802 8.21799 19.908C8.40973 20.2843 8.71569 20.5903 9.09202 20.782C9.51984 21 10.0799 21 11.2 21Z"
                            stroke="#828385"
                            strokeWidth="2"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                          />
                        </svg>
                      </div>
                      <div className="cursor-pointer">
                        <svg width="16" height="16" viewBox="0 0 24 24">
                          <path
                            fill="none"
                            stroke="#828385"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M7 21H3a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h4l4-9a3 3 0 0 1 3 3v4h6a2 2.3 0 0 1 2 3l-2 8a3 3 0 0 1-3 2h-6zV11"
                          />
                        </svg>
                      </div>
                      <div className="cursor-pointer">
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 22 22"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M15.9991 1V12M20.9991 8.8V4.2C20.9991 3.07989 20.9991 2.51984 20.7811 2.09202C20.5893 1.71569 20.2834 1.40973 19.9071 1.21799C19.4792 1 18.9192 1 17.7991 1H7.11709C5.65561 1 4.92486 1 4.33466 1.26743C3.81447 1.50314 3.37238 1.88242 3.06032 2.36072C2.70625 2.90339 2.59513 3.62564 2.3729 5.07012L1.84983 8.47012C1.55672 10.3753 1.41017 11.3279 1.69288 12.0691C1.94102 12.7197 2.40773 13.2637 3.013 13.6079C3.70261 14 4.66641 14 6.59401 14H7.39908C7.95913 14 8.23916 14 8.45307 14.109C8.64123 14.2049 8.79421 14.3578 8.89008 14.546C8.99908 14.7599 8.99908 15.0399 8.99908 15.6V18.5342C8.99908 19.896 10.1031 21 11.4649 21C11.7897 21 12.0841 20.8087 12.216 20.5119L15.5768 12.9502C15.7296 12.6062 15.8061 12.4343 15.9269 12.3082C16.0337 12.1967 16.1648 12.1115 16.31 12.0592C16.4743 12 16.6625 12 17.0389 12H17.7991C18.9192 12 19.4792 12 19.9071 11.782C20.2834 11.5903 20.5893 11.2843 20.7811 10.908C20.9991 10.4802 20.9991 9.9201 20.9991 8.8Z"
                            stroke="#828385"
                            strokeWidth="2"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                          />
                        </svg>
                      </div>
                      <div
                        className="cursor-pointer"
                        onClick={() => {
                          let msg = messages.slice(0, index);
                          const pro = messages[index - 1];
                          dispatch(setMessages([...messages.slice(0, index)]));
                          generateResult(msg, pro.content);
                        }}
                      >
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 21 20"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M1 8C1 8 3.00498 5.26822 4.63384 3.63824C6.26269 2.00827 8.5136 1 11 1C15.9706 1 20 5.02944 20 10C20 14.9706 15.9706 19 11 19C6.89691 19 3.43511 16.2543 2.35177 12.5M1 8V2M1 8H7"
                            stroke="#828385"
                            strokeWidth="2"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                          />
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
              );
            }
          })}
          {generating && (
            <div className="flex gap-3 w-3/4" key={"loading"}>
              <div className="flex bg-white w-12 h-12 rounded-full justify-center items-center">
                <svg
                  width="48"
                  height="48"
                  viewBox="0 0 835 462"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M417.431 245.818C484.709 245.818 539.249 191.278 539.249 124C539.249 56.7217 484.709 2.18182 417.431 2.18182C350.153 2.18182 295.613 56.7217 295.613 124C295.613 191.278 350.153 245.818 417.431 245.818Z"
                    stroke="#E1E1EA"
                    strokeWidth="3.63636"
                  />
                  <rect
                    x="341.067"
                    y="47.6365"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#1E47D1"
                  />
                  <rect
                    x="395.613"
                    y="47.6365"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#4DA7ED"
                  />
                  <rect
                    x="450.158"
                    y="47.6365"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#3172DC"
                  />
                  <rect
                    x="341.067"
                    y="102.182"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#4DA7ED"
                  />
                  <rect
                    x="395.613"
                    y="102.182"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#3172DC"
                  />
                  <rect
                    x="450.158"
                    y="102.182"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#73F7FA"
                  />
                  <rect
                    x="341.067"
                    y="156.727"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#3B83E3"
                  />
                  <rect
                    x="395.613"
                    y="156.727"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#73F7FA"
                  />
                  <rect
                    x="450.158"
                    y="156.727"
                    width="40"
                    height="40"
                    rx="14.5455"
                    fill="#3B83E3"
                  />
                  <path
                    d="M97.4191 422V342.15H119.534V364.71L116.417 358.179C118.792 352.539 122.601 348.285 127.845 345.415C133.089 342.447 139.471 340.963 146.991 340.963V362.335C146.002 362.236 145.111 362.187 144.32 362.187C143.528 362.088 142.687 362.038 141.797 362.038C135.464 362.038 130.319 363.869 126.361 367.53C122.502 371.092 120.573 376.682 120.573 384.301V422H97.4191ZM207.673 423.187C199.065 423.187 191.396 421.456 184.668 417.993C177.94 414.431 172.646 409.533 168.787 403.299C165.027 397.065 163.147 389.991 163.147 382.075C163.147 374.06 165.027 366.986 168.787 360.851C172.646 354.617 177.94 349.769 184.668 346.306C191.396 342.744 199.065 340.963 207.673 340.963C216.084 340.963 223.406 342.744 229.639 346.306C235.873 349.769 240.474 354.766 243.442 361.296L225.483 370.944C223.406 367.184 220.783 364.413 217.617 362.632C214.55 360.851 211.186 359.96 207.525 359.96C203.567 359.96 200.005 360.851 196.838 362.632C193.672 364.413 191.149 366.936 189.269 370.201C187.488 373.467 186.597 377.425 186.597 382.075C186.597 386.726 187.488 390.683 189.269 393.949C191.149 397.214 193.672 399.737 196.838 401.518C200.005 403.299 203.567 404.19 207.525 404.19C211.186 404.19 214.55 403.349 217.617 401.666C220.783 399.885 223.406 397.065 225.483 393.207L243.442 403.002C240.474 409.434 235.873 414.431 229.639 417.993C223.406 421.456 216.084 423.187 207.673 423.187ZM367.94 340.963C374.272 340.963 379.863 342.249 384.711 344.822C389.659 347.295 393.518 351.154 396.288 356.398C399.158 361.544 400.592 368.173 400.592 376.287V422H377.439V379.849C377.439 373.417 376.103 368.668 373.431 365.6C370.76 362.533 367 360.999 362.152 360.999C358.787 360.999 355.769 361.791 353.098 363.374C350.426 364.858 348.348 367.134 346.864 370.201C345.38 373.269 344.638 377.177 344.638 381.927V422H321.484V379.849C321.484 373.417 320.149 368.668 317.477 365.6C314.904 362.533 311.194 360.999 306.346 360.999C302.981 360.999 299.964 361.791 297.292 363.374C294.62 364.858 292.543 367.134 291.058 370.201C289.574 373.269 288.832 377.177 288.832 381.927V422H265.679V342.15H287.793V363.968L283.637 357.586C286.408 352.144 290.316 348.037 295.363 345.267C300.508 342.397 306.346 340.963 312.876 340.963C320.198 340.963 326.58 342.843 332.022 346.603C337.563 350.264 341.224 355.904 343.005 363.523L334.842 361.296C337.514 355.063 341.768 350.115 347.606 346.454C353.543 342.793 360.321 340.963 367.94 340.963ZM482.049 423.781C473.837 423.781 466.267 422.495 459.341 419.922C452.514 417.251 446.527 413.491 441.382 408.642C436.336 403.794 432.378 398.104 429.509 391.574C426.738 385.043 425.353 377.87 425.353 370.053C425.353 362.236 426.738 355.063 429.509 348.532C432.378 342.002 436.385 336.312 441.531 331.464C446.676 326.615 452.712 322.905 459.638 320.332C466.564 317.661 474.183 316.325 482.495 316.325C491.697 316.325 499.959 317.859 507.281 320.926C514.702 323.993 520.935 328.446 525.982 334.284L510.546 348.532C506.786 344.574 502.68 341.655 498.227 339.775C493.774 337.796 488.926 336.807 483.682 336.807C478.636 336.807 474.035 337.599 469.879 339.182C465.723 340.765 462.112 343.041 459.044 346.009C456.076 348.977 453.751 352.49 452.068 356.547C450.485 360.604 449.694 365.106 449.694 370.053C449.694 374.901 450.485 379.354 452.068 383.411C453.751 387.468 456.076 391.03 459.044 394.097C462.112 397.065 465.674 399.341 469.73 400.924C473.886 402.508 478.438 403.299 483.385 403.299C488.134 403.299 492.735 402.557 497.188 401.073C501.74 399.49 506.143 396.868 510.397 393.207L524.052 410.572C518.412 414.826 511.832 418.092 504.312 420.367C496.891 422.643 489.47 423.781 482.049 423.781ZM502.086 407.455V368.42H524.052V410.572L502.086 407.455ZM555.292 422V318.106H600.263C609.564 318.106 617.579 319.64 624.307 322.707C631.036 325.675 636.231 329.98 639.892 335.62C643.553 341.26 645.383 347.988 645.383 355.805C645.383 363.523 643.553 370.201 639.892 375.841C636.231 381.481 631.036 385.835 624.307 388.902C617.579 391.871 609.564 393.355 600.263 393.355H568.65L579.336 382.52V422H555.292ZM579.336 385.192L568.65 373.764H598.928C606.349 373.764 611.89 372.18 615.551 369.014C619.212 365.848 621.042 361.445 621.042 355.805C621.042 350.066 619.212 345.613 615.551 342.447C611.89 339.281 606.349 337.697 598.928 337.697H568.65L579.336 326.269V385.192ZM690.221 422V337.697H656.975V318.106H747.511V337.697H714.265V422H690.221Z"
                    fill="#1E47D1"
                  />
                  <path
                    d="M763.996 314V294.384H756.316V291.6H774.844V294.384H767.164V314H763.996ZM779.609 314V291.6H782.233L792.281 308.528H790.873L800.793 291.6H803.417L803.449 314H800.377L800.345 296.432H801.081L792.249 311.28H790.777L781.881 296.432H782.681V314H779.609Z"
                    fill="#1E47D1"
                  />
                </svg>
              </div>
              <div className="flex flex-col w-full gap-2">
                <div className="flex items-center justify-between">
                  <div className="font-semibold text-[14px] font-inter"></div>
                  <div className="text-[12px] font-normal font-inter text-[#45484C]"></div>
                </div>
                <div className="bg-white text-[#151618] text-[14px] font-normal px-[10px] py-[14px] rounded-r-xl rounded-bl-xl">
                  <div className="dots-3"></div>
                </div>
              </div>
            </div>
          )}
        </div>
        {showSampleQuestion && (
          <div className="flex flex-col items-start gap-1 p-2">
            <div
              className="rounded-full border border-[#005DE2] bg-white py-2 px-4 cursor-pointer select-none w-[100%] md:w-auto"
              onClick={() => {
                dispatch(setShowSampleQuestion(false));
                sendPrompt("What is the timely filing policy for BCBS?");
              }}
            >
              <div className="font-inter text-[16px] font-medium text-[#005DE2] p-0">
                What is the timely filing policy for BCBS?
              </div>
            </div>
            <div
              className="rounded-full border border-[#005DE2] bg-white py-2 px-4 cursor-pointer select-none w-[100%] md:w-auto"
              onClick={() => {
                dispatch(setShowSampleQuestion(false));
                sendPrompt(
                  "What is the address to send an appeal for United Healthcare?"
                );
              }}
            >
              <div className="font-inter text-[16px] font-medium text-[#005DE2] p-0">
                What is the address to send an appeal for United Healthcare?
              </div>
            </div>
            <div
              className="rounded-full border border-[#005DE2] bg-white py-2 px-4 cursor-pointer select-none w-[100%] md:w-auto"
              onClick={() => {
                dispatch(setShowSampleQuestion(false));
                sendPrompt("What is the CPT code for forearm crutches?");
              }}
            >
              <div className="font-inter text-[16px] font-medium text-[#005DE2] p-0">
                What is the CPT code for forearm crutches?
              </div>
            </div>
          </div>
        )}
        <div className="flex gap-2 border-t p-2">
          <input
            placeholder="Type your question here"
            value={prompt}
            onChange={(e) => setPrompt(e.target.value)}
            onKeyDown={(e) =>
              e.keyCode == 13 && !generating && sendPrompt(prompt)
            }
            className="text-sm select-none rounded-lg block w-full py-3 px-4 text-gray-500 bg-white hover:bg-gray-100 hover:text-gray-700 "
          />
          <div className="flex w-14 h-14 bg-[white] rounded-xl justify-center items-center cursor-pointer">
            <svg
              width="22"
              height="22"
              viewBox="0 0 22 22"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.7076 17.3644L10.2933 18.7786C8.34072 20.7313 5.1749 20.7313 3.22228 18.7786C1.26966 16.826 1.26966 13.6602 3.22228 11.7076L4.63649 10.2933M17.3644 11.7076L18.7786 10.2933C20.7312 8.34072 20.7312 5.1749 18.7786 3.22228C16.826 1.26966 13.6602 1.26966 11.7076 3.22228L10.2933 4.63649M7.50045 14.5004L14.5005 7.50043"
                stroke="#0D364D"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
              />
            </svg>
          </div>
          <div
            className={`flex w-14 h-14 bg-[#EFF4FE] rounded-xl justify-center items-center ${
              generating ? "cursor-not-allowed" : "cursor-pointer"
            }`}
            onClick={() => !generating && sendPrompt(prompt)}
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M7.29289 0.292893C7.68342 -0.0976311 8.31658 -0.0976311 8.70711 0.292893L15.7071 7.29289C16.0976 7.68342 16.0976 8.31658 15.7071 8.70711C15.3166 9.09763 14.6834 9.09763 14.2929 8.70711L9 3.41421V15C9 15.5523 8.55228 16 8 16C7.44772 16 7 15.5523 7 15V3.41421L1.70711 8.70711C1.31658 9.09763 0.683417 9.09763 0.292893 8.70711C-0.0976311 8.31658 -0.0976311 7.68342 0.292893 7.29289L7.29289 0.292893Z"
                fill="#0D364D"
              />
            </svg>
          </div>
        </div>
      </div>

      <div
        className={`absolute z-[100] bg-[#005DE21A] backdrop-blur-sm w-[100vw] h-[100vh] left-0 top-0 ${
          showHistory ? "block" : "hidden"
        } md:hidden`}
      >
        <div className="w-[70%] h-[100%] bg-[#EFF4FE] p-5" ref={history}>
          <div className="flex flex-col gap-2">
            <div>
              <span className="text-[20px] font-semibold text-[#072F40]">
                All Chats
              </span>
            </div>

            <span className="text-[16px] p-5 bg-white rounded-2xl">
              New Chat
            </span>

            <span className="font-normal text-[#686B7E] text-[16px] pl-5">
              Today
            </span>

            <span className="text-[16px] p-5 bg-white rounded-2xl">
              What is the CPT code for walking...
            </span>

            <span className="font-normal text-[#686B7E] text-[16px] pl-5">
              Last 7 days
            </span>

            <span className="text-[16px] p-5 bg-white rounded-2xl">
              What is the CPT code for walking...
            </span>
            <span className="text-[16px] p-5 bg-white rounded-2xl">
              What is the CPT code for walking...
            </span>
            <span className="text-[16px] p-5 bg-white rounded-2xl">
              What is the CPT code for walking...
            </span>
            <span className="text-[16px] p-5 bg-white rounded-2xl">
              What is the CPT code for walking...
            </span>
          </div>
        </div>
      </div>

      <Dialog fullScreen open={showModal} className="hidden md:block">
        <div className="p-6 flex flex-col gap-2 h-[100vh]">
          <div className="flex flex-row justify-between items-center">
            <span className="text-[32px] font-semibold text-[#072F40]">
              Aaftaab Assistant
            </span>
            <div className="flex items-center gap-5">
              <div>
                <svg width="1.5em" height="1.5em" viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M18.22 20.75H5.78A2.64 2.64 0 0 1 3.25 18v-3a.75.75 0 0 1 1.5 0v3a1.16 1.16 0 0 0 1 1.25h12.47a1.16 1.16 0 0 0 1-1.25v-3a.75.75 0 0 1 1.5 0v3a2.64 2.64 0 0 1-2.5 2.75"
                  />
                  <path
                    fill="currentColor"
                    d="M12 15.75a.74.74 0 0 1-.53-.22l-4-4a.75.75 0 0 1 1.06-1.06L12 13.94l3.47-3.47a.75.75 0 0 1 1.06 1.06l-4 4a.74.74 0 0 1-.53.22"
                  />
                  <path
                    fill="#1C274C"
                    d="M12 15.75a.76.76 0 0 1-.75-.75V4a.75.75 0 0 1 1.5 0v11a.76.76 0 0 1-.75.75"
                  />
                </svg>
              </div>
              <div className="cursor-pointer" onClick={handleModalClose}>
                <svg
                  width="12"
                  height="12"
                  viewBox="0 0 12 12"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M0.412046 0.41107C0.737483 0.0856329 1.26512 0.0856329 1.59056 0.41107L6.0013 4.82181L10.412 0.41107C10.7375 0.0856329 11.2651 0.0856329 11.5906 0.41107C11.916 0.736507 11.916 1.26414 11.5906 1.58958L7.17981 6.00033L11.5906 10.4111C11.916 10.7365 11.916 11.2641 11.5906 11.5896C11.2651 11.915 10.7375 11.915 10.412 11.5896L6.0013 7.17884L1.59056 11.5896C1.26512 11.915 0.737483 11.915 0.412046 11.5896C0.0866095 11.2641 0.0866095 10.7365 0.412046 10.4111L4.82279 6.00033L0.412046 1.58958C0.0866095 1.26414 0.0866095 0.736507 0.412046 0.41107Z"
                    fill="#27222C"
                  />
                </svg>
              </div>
            </div>
          </div>
          <div className="grid grid-cols-5 gap-2 flex-1 overflow-y-auto">
            <div className="col-span-1 bg-[#EFF4FE] rounded-2xl flex flex-col gap-2 p-1 overflow-y-auto">
              <ChatHistoryButton onClick={onNewChat}>
                New Chat
              </ChatHistoryButton>

              {chats.today.length !== 0 && (
                <span className="font-normal text-[#686B7E] text-[16px] pl-5">
                  Today
                </span>
              )}

              {chats.today.map((chat) => (
                <ChatHistoryButton
                  key={chat.uuid}
                  onClick={() => loadChats(chat.uuid)}
                >
                  {chat.title}
                </ChatHistoryButton>
              ))}

              {chats.yesterday.length !== 0 && (
                <span className="font-normal text-[#686B7E] text-[16px] pl-5">
                  Yesterday
                </span>
              )}

              {chats.yesterday.map((chat) => (
                <ChatHistoryButton
                  key={chat.uuid}
                  onClick={() => loadChats(chat.uuid)}
                >
                  {chat.title}
                </ChatHistoryButton>
              ))}
              {chats.lastWeek.length !== 0 && (
                <span className="font-normal text-[#686B7E] text-[16px] pl-5">
                  Last 7 days
                </span>
              )}

              {chats.lastWeek.map((chat) => (
                <ChatHistoryButton
                  key={chat.uuid}
                  onClick={() => loadChats(chat.uuid)}
                >
                  {chat.title}
                </ChatHistoryButton>
              ))}
            </div>
            <div className="col-span-4 bg-[#EFF4FE] rounded-2xl p-[6px] overflow-y-auto">
              <div className="w-[100%] h-[100%] bg-white rounded-2xl flex flex-col">
                {!showSampleQuestion && (
                  <div
                    className="overflow-scroll scroll-smooth flex-1"
                    ref={modalMessageContainer}
                  >
                    <div
                      className="flex flex-col gap-2 px-2 py-2 max-w-[800px] mx-auto"
                      ref={messageContainer}
                    >
                      {messages.map((row, index) => {
                        if (row.type === 0) {
                          return (
                            <div
                              className="flex flex-col gap-3 w-1/2 self-end"
                              key={index}
                            >
                              <div className="flex justify-between items-center">
                                <div className="text-[#1A3F59] font-inter text-[14px] font-semibold">
                                  You
                                </div>
                                <div className="text-[#45484C] text-[12px] font-normal font-inter">
                                  {rcmGPTDateFormat(row.time)}
                                </div>
                              </div>
                              <div className="py-[14px] px-[10px] bg-[#3588FF] rounded-l-xl rounded-br-xl text-white text-[14px] font-normal font-inter">
                                {row.content}
                              </div>
                            </div>
                          );
                        } else {
                          return (
                            <div className="flex gap-3 w-3/4" key={index}>
                              <div className="flex bg-white w-12 h-12 rounded-full justify-center items-center">
                                <svg
                                  width="48"
                                  height="48"
                                  viewBox="0 0 835 462"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  \
                                  <path
                                    d="M417.431 245.818C484.709 245.818 539.249 191.278 539.249 124C539.249 56.7217 484.709 2.18182 417.431 2.18182C350.153 2.18182 295.613 56.7217 295.613 124C295.613 191.278 350.153 245.818 417.431 245.818Z"
                                    stroke="#E1E1EA"
                                    strokeWidth="3.63636"
                                  />
                                  \
                                  <rect
                                    x="341.067"
                                    y="47.6365"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#1E47D1"
                                  />
                                  \
                                  <rect
                                    x="395.613"
                                    y="47.6365"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#4DA7ED"
                                  />
                                  \
                                  <rect
                                    x="450.158"
                                    y="47.6365"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#3172DC"
                                  />
                                  \
                                  <rect
                                    x="341.067"
                                    y="102.182"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#4DA7ED"
                                  />
                                  \
                                  <rect
                                    x="395.613"
                                    y="102.182"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#3172DC"
                                  />
                                  \
                                  <rect
                                    x="450.158"
                                    y="102.182"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#73F7FA"
                                  />
                                  \
                                  <rect
                                    x="341.067"
                                    y="156.727"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#3B83E3"
                                  />
                                  \
                                  <rect
                                    x="395.613"
                                    y="156.727"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#73F7FA"
                                  />
                                  \
                                  <rect
                                    x="450.158"
                                    y="156.727"
                                    width="40"
                                    height="40"
                                    rx="14.5455"
                                    fill="#3B83E3"
                                  />
                                  \
                                  <path
                                    d="M97.4191 422V342.15H119.534V364.71L116.417 358.179C118.792 352.539 122.601 348.285 127.845 345.415C133.089 342.447 139.471 340.963 146.991 340.963V362.335C146.002 362.236 145.111 362.187 144.32 362.187C143.528 362.088 142.687 362.038 141.797 362.038C135.464 362.038 130.319 363.869 126.361 367.53C122.502 371.092 120.573 376.682 120.573 384.301V422H97.4191ZM207.673 423.187C199.065 423.187 191.396 421.456 184.668 417.993C177.94 414.431 172.646 409.533 168.787 403.299C165.027 397.065 163.147 389.991 163.147 382.075C163.147 374.06 165.027 366.986 168.787 360.851C172.646 354.617 177.94 349.769 184.668 346.306C191.396 342.744 199.065 340.963 207.673 340.963C216.084 340.963 223.406 342.744 229.639 346.306C235.873 349.769 240.474 354.766 243.442 361.296L225.483 370.944C223.406 367.184 220.783 364.413 217.617 362.632C214.55 360.851 211.186 359.96 207.525 359.96C203.567 359.96 200.005 360.851 196.838 362.632C193.672 364.413 191.149 366.936 189.269 370.201C187.488 373.467 186.597 377.425 186.597 382.075C186.597 386.726 187.488 390.683 189.269 393.949C191.149 397.214 193.672 399.737 196.838 401.518C200.005 403.299 203.567 404.19 207.525 404.19C211.186 404.19 214.55 403.349 217.617 401.666C220.783 399.885 223.406 397.065 225.483 393.207L243.442 403.002C240.474 409.434 235.873 414.431 229.639 417.993C223.406 421.456 216.084 423.187 207.673 423.187ZM367.94 340.963C374.272 340.963 379.863 342.249 384.711 344.822C389.659 347.295 393.518 351.154 396.288 356.398C399.158 361.544 400.592 368.173 400.592 376.287V422H377.439V379.849C377.439 373.417 376.103 368.668 373.431 365.6C370.76 362.533 367 360.999 362.152 360.999C358.787 360.999 355.769 361.791 353.098 363.374C350.426 364.858 348.348 367.134 346.864 370.201C345.38 373.269 344.638 377.177 344.638 381.927V422H321.484V379.849C321.484 373.417 320.149 368.668 317.477 365.6C314.904 362.533 311.194 360.999 306.346 360.999C302.981 360.999 299.964 361.791 297.292 363.374C294.62 364.858 292.543 367.134 291.058 370.201C289.574 373.269 288.832 377.177 288.832 381.927V422H265.679V342.15H287.793V363.968L283.637 357.586C286.408 352.144 290.316 348.037 295.363 345.267C300.508 342.397 306.346 340.963 312.876 340.963C320.198 340.963 326.58 342.843 332.022 346.603C337.563 350.264 341.224 355.904 343.005 363.523L334.842 361.296C337.514 355.063 341.768 350.115 347.606 346.454C353.543 342.793 360.321 340.963 367.94 340.963ZM482.049 423.781C473.837 423.781 466.267 422.495 459.341 419.922C452.514 417.251 446.527 413.491 441.382 408.642C436.336 403.794 432.378 398.104 429.509 391.574C426.738 385.043 425.353 377.87 425.353 370.053C425.353 362.236 426.738 355.063 429.509 348.532C432.378 342.002 436.385 336.312 441.531 331.464C446.676 326.615 452.712 322.905 459.638 320.332C466.564 317.661 474.183 316.325 482.495 316.325C491.697 316.325 499.959 317.859 507.281 320.926C514.702 323.993 520.935 328.446 525.982 334.284L510.546 348.532C506.786 344.574 502.68 341.655 498.227 339.775C493.774 337.796 488.926 336.807 483.682 336.807C478.636 336.807 474.035 337.599 469.879 339.182C465.723 340.765 462.112 343.041 459.044 346.009C456.076 348.977 453.751 352.49 452.068 356.547C450.485 360.604 449.694 365.106 449.694 370.053C449.694 374.901 450.485 379.354 452.068 383.411C453.751 387.468 456.076 391.03 459.044 394.097C462.112 397.065 465.674 399.341 469.73 400.924C473.886 402.508 478.438 403.299 483.385 403.299C488.134 403.299 492.735 402.557 497.188 401.073C501.74 399.49 506.143 396.868 510.397 393.207L524.052 410.572C518.412 414.826 511.832 418.092 504.312 420.367C496.891 422.643 489.47 423.781 482.049 423.781ZM502.086 407.455V368.42H524.052V410.572L502.086 407.455ZM555.292 422V318.106H600.263C609.564 318.106 617.579 319.64 624.307 322.707C631.036 325.675 636.231 329.98 639.892 335.62C643.553 341.26 645.383 347.988 645.383 355.805C645.383 363.523 643.553 370.201 639.892 375.841C636.231 381.481 631.036 385.835 624.307 388.902C617.579 391.871 609.564 393.355 600.263 393.355H568.65L579.336 382.52V422H555.292ZM579.336 385.192L568.65 373.764H598.928C606.349 373.764 611.89 372.18 615.551 369.014C619.212 365.848 621.042 361.445 621.042 355.805C621.042 350.066 619.212 345.613 615.551 342.447C611.89 339.281 606.349 337.697 598.928 337.697H568.65L579.336 326.269V385.192ZM690.221 422V337.697H656.975V318.106H747.511V337.697H714.265V422H690.221Z"
                                    fill="#1E47D1"
                                  />
                                  \
                                  <path
                                    d="M763.996 314V294.384H756.316V291.6H774.844V294.384H767.164V314H763.996ZM779.609 314V291.6H782.233L792.281 308.528H790.873L800.793 291.6H803.417L803.449 314H800.377L800.345 296.432H801.081L792.249 311.28H790.777L781.881 296.432H782.681V314H779.609Z"
                                    fill="#1E47D1"
                                  />
                                  \
                                </svg>
                              </div>
                              <div className="flex flex-col w-full gap-2">
                                <div className="flex items-center justify-between">
                                  <div className="font-semibold text-[14px] font-inter"></div>
                                  <div className="text-[12px] font-normal font-inter text-[#45484C]">
                                    {rcmGPTDateFormat(row.time)}
                                  </div>
                                </div>
                                <div className="bg-[#E7EFFA66] text-[#151618] text-[14px] font-normal px-[10px] py-[14px] rounded-r-xl rounded-bl-xl select-text">
                                  {row.content
                                    .split("\n")
                                    .map((line, index) => (
                                      <div key={index}>{formatText(line)}</div>
                                    ))}
                                </div>
                                <div className="flex gap-2">
                                  <div className="cursor-pointer">
                                    <svg
                                      width="16"
                                      height="16"
                                      viewBox="0 0 24 24"
                                    >
                                      <path
                                        fill="none"
                                        stroke="#828385"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M15.5 8.43A5 5 0 0 1 17 12a4.98 4.98 0 0 1-1.43 3.5m2.794 2.864A8.97 8.97 0 0 0 21 12a8.97 8.97 0 0 0-2.636-6.364M12 6.135v11.73a1 1 0 0 1-1.64.768L6 15H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h2l4.36-3.633a1 1 0 0 1 1.64.768"
                                      />
                                    </svg>
                                  </div>
                                  <div
                                    className="cursor-pointer"
                                    onClick={() => {
                                      navigator.clipboard.writeText(
                                        row.content
                                      );
                                      toast.success("Text copied!", {
                                        position: "bottom-center",
                                      });
                                    }}
                                  >
                                    <svg
                                      width="16"
                                      height="16"
                                      viewBox="0 0 22 22"
                                      fill="none"
                                      xmlns="http://www.w3.org/2000/svg"
                                    >
                                      <path
                                        d="M4 14C3.06812 14 2.60218 14 2.23463 13.8478C1.74458 13.6448 1.35523 13.2554 1.15224 12.7654C1 12.3978 1 11.9319 1 11V4.2C1 3.0799 1 2.51984 1.21799 2.09202C1.40973 1.71569 1.71569 1.40973 2.09202 1.21799C2.51984 1 3.0799 1 4.2 1H11C11.9319 1 12.3978 1 12.7654 1.15224C13.2554 1.35523 13.6448 1.74458 13.8478 2.23463C14 2.60218 14 3.06812 14 4M11.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V11.2C21 10.0799 21 9.51984 20.782 9.09202C20.5903 8.71569 20.2843 8.40973 19.908 8.21799C19.4802 8 18.9201 8 17.8 8H11.2C10.0799 8 9.51984 8 9.09202 8.21799C8.71569 8.40973 8.40973 8.71569 8.21799 9.09202C8 9.51984 8 10.0799 8 11.2V17.8C8 18.9201 8 19.4802 8.21799 19.908C8.40973 20.2843 8.71569 20.5903 9.09202 20.782C9.51984 21 10.0799 21 11.2 21Z"
                                        stroke="#828385"
                                        strokeWidth="2"
                                        strokeLinecap="round"
                                        strokeLinejoin="round"
                                      />
                                    </svg>
                                  </div>
                                  <div className="cursor-pointer">
                                    <svg
                                      width="16"
                                      height="16"
                                      viewBox="0 0 24 24"
                                    >
                                      <path
                                        fill="none"
                                        stroke="#828385"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M7 21H3a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h4l4-9a3 3 0 0 1 3 3v4h6a2 2.3 0 0 1 2 3l-2 8a3 3 0 0 1-3 2h-6zV11"
                                      />
                                    </svg>
                                  </div>
                                  <div className="cursor-pointer">
                                    <svg
                                      width="16"
                                      height="16"
                                      viewBox="0 0 22 22"
                                      fill="none"
                                      xmlns="http://www.w3.org/2000/svg"
                                    >
                                      <path
                                        d="M15.9991 1V12M20.9991 8.8V4.2C20.9991 3.07989 20.9991 2.51984 20.7811 2.09202C20.5893 1.71569 20.2834 1.40973 19.9071 1.21799C19.4792 1 18.9192 1 17.7991 1H7.11709C5.65561 1 4.92486 1 4.33466 1.26743C3.81447 1.50314 3.37238 1.88242 3.06032 2.36072C2.70625 2.90339 2.59513 3.62564 2.3729 5.07012L1.84983 8.47012C1.55672 10.3753 1.41017 11.3279 1.69288 12.0691C1.94102 12.7197 2.40773 13.2637 3.013 13.6079C3.70261 14 4.66641 14 6.59401 14H7.39908C7.95913 14 8.23916 14 8.45307 14.109C8.64123 14.2049 8.79421 14.3578 8.89008 14.546C8.99908 14.7599 8.99908 15.0399 8.99908 15.6V18.5342C8.99908 19.896 10.1031 21 11.4649 21C11.7897 21 12.0841 20.8087 12.216 20.5119L15.5768 12.9502C15.7296 12.6062 15.8061 12.4343 15.9269 12.3082C16.0337 12.1967 16.1648 12.1115 16.31 12.0592C16.4743 12 16.6625 12 17.0389 12H17.7991C18.9192 12 19.4792 12 19.9071 11.782C20.2834 11.5903 20.5893 11.2843 20.7811 10.908C20.9991 10.4802 20.9991 9.9201 20.9991 8.8Z"
                                        stroke="#828385"
                                        strokeWidth="2"
                                        strokeLinecap="round"
                                        strokeLinejoin="round"
                                      />
                                    </svg>
                                  </div>
                                  <div
                                    className="cursor-pointer"
                                    onClick={() => {
                                      let msg = messages.slice(0, index);
                                      const pro = messages[index - 1];
                                      dispatch(
                                        setMessages([
                                          ...messages.slice(0, index),
                                        ])
                                      );
                                      generateResult(msg, pro.content);
                                    }}
                                  >
                                    <svg
                                      width="16"
                                      height="16"
                                      viewBox="0 0 21 20"
                                      fill="none"
                                      xmlns="http://www.w3.org/2000/svg"
                                    >
                                      <path
                                        d="M1 8C1 8 3.00498 5.26822 4.63384 3.63824C6.26269 2.00827 8.5136 1 11 1C15.9706 1 20 5.02944 20 10C20 14.9706 15.9706 19 11 19C6.89691 19 3.43511 16.2543 2.35177 12.5M1 8V2M1 8H7"
                                        stroke="#828385"
                                        strokeWidth="2"
                                        strokeLinecap="round"
                                        strokeLinejoin="round"
                                      />
                                    </svg>
                                  </div>
                                </div>
                              </div>
                            </div>
                          );
                        }
                      })}
                      {generating && (
                        <div
                          className="flex gap-3 max-w-[800px]"
                          key={"loading"}
                        >
                          <div className="flex bg-white w-12 h-12 rounded-full justify-center items-center">
                            <svg
                              width="48"
                              height="48"
                              viewBox="0 0 835 462"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                            >
                              <path
                                d="M417.431 245.818C484.709 245.818 539.249 191.278 539.249 124C539.249 56.7217 484.709 2.18182 417.431 2.18182C350.153 2.18182 295.613 56.7217 295.613 124C295.613 191.278 350.153 245.818 417.431 245.818Z"
                                stroke="#E1E1EA"
                                strokeWidth="3.63636"
                              />
                              <rect
                                x="341.067"
                                y="47.6365"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#1E47D1"
                              />
                              <rect
                                x="395.613"
                                y="47.6365"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#4DA7ED"
                              />
                              <rect
                                x="450.158"
                                y="47.6365"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#3172DC"
                              />
                              <rect
                                x="341.067"
                                y="102.182"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#4DA7ED"
                              />
                              <rect
                                x="395.613"
                                y="102.182"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#3172DC"
                              />
                              <rect
                                x="450.158"
                                y="102.182"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#73F7FA"
                              />
                              <rect
                                x="341.067"
                                y="156.727"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#3B83E3"
                              />
                              <rect
                                x="395.613"
                                y="156.727"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#73F7FA"
                              />
                              <rect
                                x="450.158"
                                y="156.727"
                                width="40"
                                height="40"
                                rx="14.5455"
                                fill="#3B83E3"
                              />
                              <path
                                d="M97.4191 422V342.15H119.534V364.71L116.417 358.179C118.792 352.539 122.601 348.285 127.845 345.415C133.089 342.447 139.471 340.963 146.991 340.963V362.335C146.002 362.236 145.111 362.187 144.32 362.187C143.528 362.088 142.687 362.038 141.797 362.038C135.464 362.038 130.319 363.869 126.361 367.53C122.502 371.092 120.573 376.682 120.573 384.301V422H97.4191ZM207.673 423.187C199.065 423.187 191.396 421.456 184.668 417.993C177.94 414.431 172.646 409.533 168.787 403.299C165.027 397.065 163.147 389.991 163.147 382.075C163.147 374.06 165.027 366.986 168.787 360.851C172.646 354.617 177.94 349.769 184.668 346.306C191.396 342.744 199.065 340.963 207.673 340.963C216.084 340.963 223.406 342.744 229.639 346.306C235.873 349.769 240.474 354.766 243.442 361.296L225.483 370.944C223.406 367.184 220.783 364.413 217.617 362.632C214.55 360.851 211.186 359.96 207.525 359.96C203.567 359.96 200.005 360.851 196.838 362.632C193.672 364.413 191.149 366.936 189.269 370.201C187.488 373.467 186.597 377.425 186.597 382.075C186.597 386.726 187.488 390.683 189.269 393.949C191.149 397.214 193.672 399.737 196.838 401.518C200.005 403.299 203.567 404.19 207.525 404.19C211.186 404.19 214.55 403.349 217.617 401.666C220.783 399.885 223.406 397.065 225.483 393.207L243.442 403.002C240.474 409.434 235.873 414.431 229.639 417.993C223.406 421.456 216.084 423.187 207.673 423.187ZM367.94 340.963C374.272 340.963 379.863 342.249 384.711 344.822C389.659 347.295 393.518 351.154 396.288 356.398C399.158 361.544 400.592 368.173 400.592 376.287V422H377.439V379.849C377.439 373.417 376.103 368.668 373.431 365.6C370.76 362.533 367 360.999 362.152 360.999C358.787 360.999 355.769 361.791 353.098 363.374C350.426 364.858 348.348 367.134 346.864 370.201C345.38 373.269 344.638 377.177 344.638 381.927V422H321.484V379.849C321.484 373.417 320.149 368.668 317.477 365.6C314.904 362.533 311.194 360.999 306.346 360.999C302.981 360.999 299.964 361.791 297.292 363.374C294.62 364.858 292.543 367.134 291.058 370.201C289.574 373.269 288.832 377.177 288.832 381.927V422H265.679V342.15H287.793V363.968L283.637 357.586C286.408 352.144 290.316 348.037 295.363 345.267C300.508 342.397 306.346 340.963 312.876 340.963C320.198 340.963 326.58 342.843 332.022 346.603C337.563 350.264 341.224 355.904 343.005 363.523L334.842 361.296C337.514 355.063 341.768 350.115 347.606 346.454C353.543 342.793 360.321 340.963 367.94 340.963ZM482.049 423.781C473.837 423.781 466.267 422.495 459.341 419.922C452.514 417.251 446.527 413.491 441.382 408.642C436.336 403.794 432.378 398.104 429.509 391.574C426.738 385.043 425.353 377.87 425.353 370.053C425.353 362.236 426.738 355.063 429.509 348.532C432.378 342.002 436.385 336.312 441.531 331.464C446.676 326.615 452.712 322.905 459.638 320.332C466.564 317.661 474.183 316.325 482.495 316.325C491.697 316.325 499.959 317.859 507.281 320.926C514.702 323.993 520.935 328.446 525.982 334.284L510.546 348.532C506.786 344.574 502.68 341.655 498.227 339.775C493.774 337.796 488.926 336.807 483.682 336.807C478.636 336.807 474.035 337.599 469.879 339.182C465.723 340.765 462.112 343.041 459.044 346.009C456.076 348.977 453.751 352.49 452.068 356.547C450.485 360.604 449.694 365.106 449.694 370.053C449.694 374.901 450.485 379.354 452.068 383.411C453.751 387.468 456.076 391.03 459.044 394.097C462.112 397.065 465.674 399.341 469.73 400.924C473.886 402.508 478.438 403.299 483.385 403.299C488.134 403.299 492.735 402.557 497.188 401.073C501.74 399.49 506.143 396.868 510.397 393.207L524.052 410.572C518.412 414.826 511.832 418.092 504.312 420.367C496.891 422.643 489.47 423.781 482.049 423.781ZM502.086 407.455V368.42H524.052V410.572L502.086 407.455ZM555.292 422V318.106H600.263C609.564 318.106 617.579 319.64 624.307 322.707C631.036 325.675 636.231 329.98 639.892 335.62C643.553 341.26 645.383 347.988 645.383 355.805C645.383 363.523 643.553 370.201 639.892 375.841C636.231 381.481 631.036 385.835 624.307 388.902C617.579 391.871 609.564 393.355 600.263 393.355H568.65L579.336 382.52V422H555.292ZM579.336 385.192L568.65 373.764H598.928C606.349 373.764 611.89 372.18 615.551 369.014C619.212 365.848 621.042 361.445 621.042 355.805C621.042 350.066 619.212 345.613 615.551 342.447C611.89 339.281 606.349 337.697 598.928 337.697H568.65L579.336 326.269V385.192ZM690.221 422V337.697H656.975V318.106H747.511V337.697H714.265V422H690.221Z"
                                fill="#1E47D1"
                              />
                              <path
                                d="M763.996 314V294.384H756.316V291.6H774.844V294.384H767.164V314H763.996ZM779.609 314V291.6H782.233L792.281 308.528H790.873L800.793 291.6H803.417L803.449 314H800.377L800.345 296.432H801.081L792.249 311.28H790.777L781.881 296.432H782.681V314H779.609Z"
                                fill="#1E47D1"
                              />
                            </svg>
                          </div>
                          <div className="flex flex-col w-full gap-2">
                            <div className="flex items-center justify-between">
                              <div className="font-semibold text-[14px] font-inter"></div>
                              <div className="text-[12px] font-normal font-inter text-[#45484C]"></div>
                            </div>
                            <div className="bg-white text-[#151618] text-[14px] font-normal px-[10px] py-[14px] rounded-r-xl rounded-bl-xl">
                              <div className="dots-3"></div>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {showSampleQuestion && (
                  <div className="flex-1 flex items-center justify-center">
                    <div className="flex flex-col gap-3 items-center">
                      <span className="text-[32px] font-bold">
                        What can we help you today?
                      </span>
                      <span className="text-[12px] text-[#686B7E] text-center">
                        Medicare Policies, Timely Filing Guidelines, CPT
                        Descriptions,
                        <br />
                        Telehealth Services, Claim Frequency Codes
                      </span>
                      <div className="flex flex-col items-center gap-1 p-2">
                        <div
                          className="rounded-full border border-[#005DE2] bg-white py-2 px-4 cursor-pointer select-none"
                          onClick={() => {
                            dispatch(setShowSampleQuestion(false));
                            sendPrompt(
                              "What is the timely filing policy for BCBS?"
                            );
                          }}
                        >
                          <div className="font-inter text-[16px] font-medium text-[#005DE2] p-0">
                            What is the timely filing policy for BCBS?
                          </div>
                        </div>
                        <div
                          className="rounded-full border border-[#005DE2] bg-white py-2 px-4 cursor-pointer select-none"
                          onClick={() => {
                            dispatch(setShowSampleQuestion(false));
                            sendPrompt(
                              "What is the address to send an appeal for United Healthcare?"
                            );
                          }}
                        >
                          <div className="font-inter text-[16px] font-medium text-[#005DE2] p-0">
                            What is the address to send an appeal for United
                            Healthcare?
                          </div>
                        </div>
                        <div
                          className="rounded-full border border-[#005DE2] bg-white py-2 px-4 cursor-pointer select-none"
                          onClick={() => {
                            dispatch(setShowSampleQuestion(false));
                            sendPrompt(
                              "What is the CPT code for forearm crutches?"
                            );
                          }}
                        >
                          <div className="font-inter text-[16px] font-medium text-[#005DE2] p-0">
                            What is the CPT code for forearm crutches?
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                <div className="flex gap-2 border-t p-2">
                  <input
                    placeholder="Type your question here"
                    value={prompt}
                    onChange={(e) => setPrompt(e.target.value)}
                    onKeyDown={(e) =>
                      e.keyCode == 13 && !generating && sendPrompt(prompt)
                    }
                    className="text-sm select-none rounded-lg block w-full py-3 px-4 text-gray-500 bg-white hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
                  />
                  <div className="flex w-14 h-14 bg-[white] rounded-xl justify-center items-center cursor-pointer">
                    <svg
                      width="22"
                      height="22"
                      viewBox="0 0 22 22"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M11.7076 17.3644L10.2933 18.7786C8.34072 20.7313 5.1749 20.7313 3.22228 18.7786C1.26966 16.826 1.26966 13.6602 3.22228 11.7076L4.63649 10.2933M17.3644 11.7076L18.7786 10.2933C20.7312 8.34072 20.7312 5.1749 18.7786 3.22228C16.826 1.26966 13.6602 1.26966 11.7076 3.22228L10.2933 4.63649M7.50045 14.5004L14.5005 7.50043"
                        stroke="#0D364D"
                        strokeWidth="2"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                    </svg>
                  </div>
                  <div
                    className={`flex w-14 h-14 bg-[#EFF4FE] rounded-xl justify-center items-center ${
                      generating ? "cursor-not-allowed" : "cursor-pointer"
                    }`}
                    onClick={() => !generating && sendPrompt(prompt)}
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M7.29289 0.292893C7.68342 -0.0976311 8.31658 -0.0976311 8.70711 0.292893L15.7071 7.29289C16.0976 7.68342 16.0976 8.31658 15.7071 8.70711C15.3166 9.09763 14.6834 9.09763 14.2929 8.70711L9 3.41421V15C9 15.5523 8.55228 16 8 16C7.44772 16 7 15.5523 7 15V3.41421L1.70711 8.70711C1.31658 9.09763 0.683417 9.09763 0.292893 8.70711C-0.0976311 8.31658 -0.0976311 7.68342 0.292893 7.29289L7.29289 0.292893Z"
                        fill="#0D364D"
                      />
                    </svg>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </Dialog>
    </div>
  );
};

export default ChatBot;
